/* ==========================================================================
   CONTROLLI SISTEMATICI - app.js
   Offline, file-based, zero framework.

   Funzioni principali:
   - Import JSON / Export JSON
   - Render sezioni + controlli (dinamico da JSON)
   - Stati: todo / ok / ko / na (KO => note obbligatorie)
   - CRUD: aggiungi/rinomina/sposta/elimina controlli e sezioni
   - PDF: modulo vuoto / stato attuale
   ========================================================================== */

/* ========================================================================== */
/* 01) STATE                                                                  */
/* ========================================================================== */

let model = null;          // JSON in memoria
let openedFileName = "";   // per suggerire il nome in export

const LOGO_JPG_BASE64 = `
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
iASQgTEI/FfgfunSWlQWcLrsGyZZo2fnYTOJDoifarqeLCWy9yg6V5P2o3R1YxeG/MKda6Gknuta
8CSgELdWvJ+1eD9qSTgMZUnNmjGwWRfjm59jYBlJ+hTnw7W1uaV9gCStjGvgE+lBkAyB2FYFh0Cr
+xxafch23RbGxge0FQkGTLA2r1CnTTHAXh0TvVml336TUCazi0T7hHpVgYzKIw08SHe5VlUvRbnp
D1rXx3kBC3VryftXk/ak85jGUX7NGKW9pSgLMmi59j/PmhBNkeyeZHo0ORlRNqxHUdtrz7G41CWf
SBt7TUiEnC3w7JX4Wg+EWFbWAOrQ1byAmliwUF8jJshJ+kTVrWfiqHEkA4FWS4Z121dhsXZvZufX
leKy7g5rhdAk7tuM7i4L2A9qEAqy18OUOH0M0m7uLC34AdaCAFxWEEph+ENMEsYsLz6DvRCwoAoq
0zTZCT9Imvz1fm6nfIwwKslwz2dh/n1E6FiXrBNalaCWQObm8tobniI7xRhyJB7JpiQKoAghvXGw
iQ5kbJJHEYjSRxtmZ4BYGeParIpWlDozU2QNoGqxch/2hkgJm91edWJ0slgW9OtAxxAERLpGJ5zS
7pCEB5CryoHCZFAWxRhZYFW3yppAll42SQCWHsopOQ/O22lVhCW7zTuRajhLMa1nl1o5H1yLmRbr
VxxTLHQLLS6LRRMt+o7bMZ8G9dPf3VIfMjHFeMNlu5FRfgHpb0pMAC8VBL0AddjHBIzsDimi5oiS
Il0jE85q7aCAk5CryotZJFAW9GFlgUJDOrIE1H+gKDfbSB1xR8UhLHkQUAXEbITMW57TQJLxrwoO
lDBq4EbQgRgPurV4QOxtG4RsAQ3UERduAuEbsUKyD3U0qDk+ykhbsSb6AuEbQFxG0IEYD7q1gkx2
2guEf/J3/9oADAMBAAIAAwAAABCSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSS
SSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSS
SSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSS
SSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSS
SSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSCSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSS
SSSSSSSSSSSSSSSSSSCSCSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSCSCS
SSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSCSCSSSSSSSSSSSSSSSSSSSSSSS
SSSSSSSSSSSSSSSSSSSSSSSSSSSSCSCSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSS
SSSSSSCSCSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSCSCSSSSSSSSSSSSS
SSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSCSCSSSSSSSSSSQLJmSSSSSSSSSSSSbrZAySSSS
SSSSSRLdp6SSSSSSCSCSSSSSSSSSOXy2GpmSSSSSQASS3ZN33TSSSSSSSSa7WWzhuSSSSSCSCSSS
SSSSSaD2S3ra0iSSSSSSCEeZFfaYeSSSSSSSWum3v77eSSSSCSCSSSSSSSTvqiGwzaicySSSSSDX
21Ieb/nGSSSSRUuDP6DbO+iSSSCSCSSSSSSSOPqiRki42wOSSSSS2Wy24O6f+ySSSSLH+R3/AIv7
t+EkkgkgkkkkkkkiTm+akk48/wCxJJJJKP7UFJET7arJJJBk3naJJMbbd8ZJIJuZJJJJJJRG1XJJ
JJG939pJJJKP+hJJJCcA8pJJJW2fpJJJMFOtJJJfszJJJJJIbddJJJJJIO5fZJJJKo7JJJJJDf8A
eSSHyQ6SSSSSRTjXySP74SSSSSRtE1ySSSSSQuiMSSSSjWSSSSSTm+mSSXMIySSSSSSIvqSSS/ky
SSSSRL/qSSSSSSSHjvSSSSjGSSSSSSTfSyQbeeSSSSSSSTf7GSFNYySSSSQdEySSSSSSSRzwiSSS
kySSSSSSfTWyQxC6SSSSSSSTB0mSW7CSSSSSSbZySSSSSSSQuxySSSUySSSSSSRgoSQS2SSSSSSS
SSD9WSCS2SSSSSbkSySSQSSSSSEkGSSSySSSSSSSR9DyQFYSSSSSSSSSRsiSIF+SSSSSK6nySSQS
SSSSSSSSSSCSSSSSSSSSSST2RSSSSCSSSSSSSSW+KSSSSSK6SSSSQSSSSSSSSSSSCSSSSSSSQSQS
S2QSSSSCSSSSSSSSbaeSSSSSaf0ySSQSSSSSSSSSSSCSSSSSSSQSQSR/+ySSSCSSSSSSSSBEOSSS
SSBvyySSQSSSSSSSSSSSCSSSSSSSQSQSRR6ySSSSSSSSSSCSX2SSSSSSR3uySSSSSSSSSSSSSSSS
SSSSSSQSQSSe3SSSSSSSSSSSSSGXeSSSSSQnyuSSSSSSSSSSSSSSSSSSSSSSQSQSQlSqSSSSSSSS
SSSSdMeSSSSSRS9aSSSSSSSSSSSSSSSSSSSSSSQSQSRj8HySSSSSSSSSSSWe4SSSSSSZ/YSSSSSS
SSSSSSSSSSSSSSSSQSQSSZX9ySSSSSSSSSSSL+0SSSSSSZEbaSSSSSTOSSSSSSSSSSSSSSQSQSSY
cTqSSSSSSMSSSSTT/wAkkkkkknu5rkkkkwpEkkkkkkkkkkkkkkEkEkk12aIkkkkDiUkkkkP/AOpJ
JJJJMcQXYPIDwkrJJJJJJJJJJJJJJBJBJJJ5ZIvxIOL/AO6SSSRXyaSSSSSSLaXeTAm4vbOSSSSS
SSSSSSSSQSQSSSRABJnowf5NGSSSQGDxiSSSSSReWb22R8WdySSSSSSSSSSSSSQSQSSSSGfb3+Tm
4rSSSSSAn9+SSSSSSQZzaAT/AIjkkkkkkkkkkkkkkkEkEkkkkai/EEXuXkkkkkkN4kkkkkkkkkDH
yZPrkkkkkkkkkkkkkkkkEkEkkkkk/wDck9pJJJJJJJJ3JJJJJJJJJJJ33vJJJJJJJJJJJJJJJJJJ
JJJJJJJJIN2pJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJ
JJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJ
JJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJ
JJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJ
JJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJDQJJ
JJJJJJJJJDJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJWTJJJJJJJJJICDJJJJJJJJJJJJ
JJJJJJJJJJJJJJJJJJJJJJJJJJJJ3KZAYBJRIQZJRaYSbJJDLSTJJJJJJJJJJJJJJJJJJJJJJJJJ
JJJJJIIDJZOgWgcKZJA5rXMxcG27NZJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJI4YYZaYCnIRJQSVJ
fKFB5FBJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJXI5ZBCLI6ZbJVJJYq9KTiARJJJJJJJJJJJJJJJ
JJJJJJJJJJJJJJJJ6ZYoYdCHBIDIdJA2JHPIIlTJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJZKZ
DRIpVJLJBbYZJZJZLJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJ
JJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJ
JJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJP/8QALhEBAAIBAgUDBQACAwADAAAAAQARIRAxIDBBUWFA
cZFQobHB8IHRYOHxgJCg/9oACAEDAQE/EP8A8xRFnG6V8QZj7oBgfp/fET1jdFIAtX6jY4nckUoJ
2SNuIfrabawbyemKt1NwbfES/wC0NtCt4Vv902BphVu/oxt1SgkIOYtuzfh2CJ2LCdWXKh7ejVJQ
RmmWA0aPEchUt78IGzETLBgMDuz0IFSiFORjKYE3tYi34QeqbOsZrI8w5emFW2fQQFu0MO7LQpcQ
8VxSIREtpY63iWH/AMeg7uiyNkA2rZewTbaAw4LmI8Idbg8VPPTU3CDMTaZ0oriN4jLxRW86OCBU
+vsTKwsS7zwl8qRQ0CrmuHGI2bSu4/lzAvENV1NhKWxgsIQgm8E3hAEAIJNtRZDCT5oIlnLBUogh
WJksdalSw6ShCGFHpwb6GaMGuxCT2PrLy7xgqEQ8FthNqUdxA2UPkmxxhGE9ybcDGVD0Qk+eWYrK
D1S72w0OW0IW7RShQ4AzDj7iJZ/Cb8M3bg2h4lQ7DPTlAOhFKtBHLdxjqF7Q2wzLmMzn6Qi/yIOr
jEt1ErfhVrxlczDASWPqk00S2vczoQ2S5t6IpdX7wGhXDVKDMtYiglNtdxHRhULD78p2aBovFDBN
wYiiCK2zY1cAChc6HUF3SI1GpUqVUaCS9tzkqX4NXMyZV3TbkyCwgDXCRRMYtVNjTcMIqlk2m8EW
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
`.replace(/\s+/g, "");
const LOGO_DATA_URL = "data:image/jpeg;base64," + LOGO_JPG_BASE64;

let logoDataUrl = null;    // cache logo per PDF

/* ========================================================================== */
/* 02) DATE & IDS                                                              */
/* ========================================================================== */

function collectAllIds(m) {
  const set = new Set();
  for (const s of m.sezioni || []) {
    set.add(s.id);
    for (const it of s.items || []) set.add(it.id);
  }
  return set;
}

function makeId(prefix) {
  const d = new Date();
  const y = d.getFullYear();
  const m = pad2(d.getMonth() + 1);
  const day = pad2(d.getDate());
  const hh = pad2(d.getHours());
  const mm = pad2(d.getMinutes());
  const ss = pad2(d.getSeconds());
  const rnd = Math.random().toString(36).slice(2, 7);
  return `${prefix}_${y}${m}${day}_${hh}${mm}${ss}_${rnd}`;
}

function makeUniqueId(prefix, existingSet) {
  let id = makeId(prefix);
  while (existingSet.has(id)) id = makeId(prefix);
  existingSet.add(id);
  return id;
}

function nowIso() {
  return new Date().toISOString();
}

function pad2(n) {
  return String(n).padStart(2, "0");
}

function sortByOrder(arr) {
  return [...arr].sort((a, b) => (a.order ?? 0) - (b.order ?? 0));
}

/* ========================================================================== */
/* 03) UI ENABLE / SUBTITLE                                                    */
/* ========================================================================== */

function enableUi(enabled) {
  const ids = [
    "btnSave", "btnPdfBlank", "btnPdfState",
    "btnExpandAll", "btnCollapseAll", "btnAddSection",
    "metaCentraleNome", "metaAnno", "metaPreposto",
    "metaDataInizio", "metaDataFine", "metaNoteGenerali",
    "metaOperatori"
  ];
  for (const id of ids) {
    const el = document.getElementById(id);
    if (!el) continue;
    if (el.tagName === "BUTTON") el.disabled = !enabled;
    else el.disabled = !enabled;
  }
}

function updateSubtitle() {
  const sub = document.getElementById("subtitle");
  const nome = model.meta.centraleNome || "(centrale non impostata)";
  const anno = model.meta.anno || "";
  sub.textContent = `${nome} | ${anno} | File: ${openedFileName || "non salvato"}`;
}

/* ========================================================================== */
/* 04) MODEL VALIDATION / NORMALIZATION                                        */
/* ========================================================================== */

function normalizeModel(m) {
  // Normalizzazione minima per evitare undefined e per garantire funzioni UI (riordino, ecc.)
  m.app = m.app || { schemaVersion: 1 };
  m.meta = m.meta || {};
  m.sezioni = Array.isArray(m.sezioni) ? m.sezioni : [];
  m.audit = m.audit || {};

  // Se mancano order (file vecchi), li assegniamo in base all'ordine corrente dell'array
  let secOrder = 10;

  for (const s of m.sezioni) {
    // id/titolo/order
    if (!s.id) s.id = makeUniqueId("sec", collectAllIds(m)); // fallback raro
    if (s.titolo === undefined) s.titolo = "";
    if (s.order === undefined || s.order === null || Number.isNaN(Number(s.order))) {
      s.order = secOrder;
    } else {
      s.order = Number(s.order);
    }
    secOrder = Math.max(secOrder, s.order) + 10;

    // items
    s.items = Array.isArray(s.items) ? s.items : [];
    let itemOrder = 10;

    for (const it of s.items) {
      if (!it.id) it.id = makeUniqueId("itm", collectAllIds(m));
      if (it.testo === undefined) it.testo = "";

      if (!it.stato) it.stato = "todo";
      if (it.note === undefined) it.note = "";
      if (it.timestamp === undefined) it.timestamp = "";

      if (it.order === undefined || it.order === null || Number.isNaN(Number(it.order))) {
        it.order = itemOrder;
      } else {
        it.order = Number(it.order);
      }
      itemOrder = Math.max(itemOrder, it.order) + 10;
    }
  }

  return m;
}

function validateModel(m) {
  if (!m || typeof m !== "object") return "JSON non valido.";
  if (!m.meta || !m.sezioni) return "Mancano meta o sezioni.";
  if (!Array.isArray(m.sezioni)) return "sezioni deve essere un array.";
  return "";
}

/* ========================================================================== */
/* 05) AUDIT                                                                   */
/* ========================================================================== */

function touchAudit() {
  if (!model.audit) model.audit = {};
  model.audit.lastModified = nowIso();
  model.audit.lastModifiedBy = (model.meta.operatori || model.meta.preposto || "").trim();
}

/* ========================================================================== */
/* 06) META BINDING                                                            */
/* ========================================================================== */

function bindMeta() {
  const fields = [
    ["metaCentraleNome", "centraleNome"],
    ["metaAnno", "anno"],
    ["metaPreposto", "preposto"],
    ["metaOperatori", "operatori"],
    ["metaDataInizio", "dataInizio"],
    ["metaDataFine", "dataFine"],
    ["metaNoteGenerali", "noteGenerali"]
  ];
  for (const [id, key] of fields) {
    const el = document.getElementById(id);
    el.addEventListener("input", () => {
      if (!model) return;
      model.meta[key] = (key === "anno") ? Number(el.value) : el.value;
      touchAudit();
      updateSubtitle();
    });
  }
}


function renderMeta() {
  document.getElementById("metaCentraleNome").value = model.meta.centraleNome ?? "";
  document.getElementById("metaAnno").value = model.meta.anno ?? "";
  document.getElementById("metaPreposto").value = model.meta.preposto ?? "";
  document.getElementById("metaOperatori").value = model.meta.operatori || "";
  document.getElementById("metaDataInizio").value = model.meta.dataInizio ?? "";
  document.getElementById("metaDataFine").value = model.meta.dataFine ?? "";
  document.getElementById("metaNoteGenerali").value = model.meta.noteGenerali ?? "";
}

/* ========================================================================== */
/* 07) SECTION STATS / PROGRESS                                                */
/* ========================================================================== */

function computeSectionBadges(section) {
  const counts = { todo: 0, ok: 0, ko: 0, na: 0 };
  for (const it of section.items || []) {
    const st = it.stato || "todo";
    if (counts[st] === undefined) counts.todo++;
    else counts[st]++;
  }
  return counts;
}

function computeSectionProgress(section) {
  const total = (section.items || []).length;
  if (total === 0) return { total: 0, done: 0, pct: 0 };

  let done = 0;
  for (const it of section.items) {
    const st = it.stato || "todo";
    if (st !== "todo") done++;
  }
  const pct = Math.round((done / total) * 100);
  return { total, done, pct };
}

function makeBadge(kind, text) {
  const span = document.createElement("span");
  span.className = `badge ${kind}`;
  span.textContent = text;
  return span;
}

function makeProgressNode(pct) {
  const wrap = document.createElement("div");
  wrap.className = "progress";

  const bar = document.createElement("div");
  bar.style.width = `${pct}%`;

  wrap.appendChild(bar);
  return wrap;
}

/* ========================================================================== */
/* 08) FINDERS                                                                 */
/* ========================================================================== */

function findItem(sectionId, itemId) {
  const s = findSection(sectionId);
  if (!s) return null;
  return (s.items || []).find(it => it.id === itemId);
}

function findSection(sectionId) {
  return model.sezioni.find(s => s.id === sectionId);
}

/* ========================================================================== */
/* 09) RENDER CORE                                                             */
/* ========================================================================== */

function getOpenSectionIds() {
  return Array.from(document.querySelectorAll("details.section"))
    .filter(d => d.open)
    .map(d => d.dataset.sectionId);
}

function makeStateButton(kind, label, isActive, onClick) {
  const b = document.createElement("button");
  b.className = `state-btn kind-${kind}` + (isActive ? " active" : "");
  b.textContent = label;
  b.addEventListener("click", onClick);
  return b;
}

function openSection(sectionId) {
  const el = document.querySelector(`details.section[data-section-id="${sectionId}"]`);
  if (el) el.open = true;
}

function renderItem(sectionId, itemId) {
  const item = findItem(sectionId, itemId);

  const wrap = document.createElement("div");
  wrap.className = "item";
  wrap.dataset.itemId = item.id;

  const grid = document.createElement("div");
  grid.className = "item-grid";

  // --- Riga titolo + strumenti (a destra del titolo) ---
  const titleRow = document.createElement("div");
  titleRow.className = "item-title-row";

  const titleLeft = document.createElement("div");
  titleLeft.className = "item-title-left";

  const text = document.createElement("div");
  text.className = "item-text";
  text.textContent = item.testo;

  titleLeft.appendChild(text);

  const tools = document.createElement("div");
  tools.className = "item-tools";

  const btnUp = document.createElement("button");
  btnUp.className = "icon-btn";
  btnUp.type = "button";
  btnUp.title = "Sposta su";
  btnUp.textContent = "";
  btnUp.disabled = !canMove(sectionId, itemId, "up");
  btnUp.addEventListener("click", () => moveItem(sectionId, itemId, "up"));

  const btnDown = document.createElement("button");
  btnDown.className = "icon-btn";
  btnDown.type = "button";
  btnDown.title = "Sposta gi";
  btnDown.textContent = "";
  btnDown.disabled = !canMove(sectionId, itemId, "down");
  btnDown.addEventListener("click", () => moveItem(sectionId, itemId, "down"));

  const btnEdit = document.createElement("button");
  btnEdit.className = "icon-btn";
  btnEdit.type = "button";
  btnEdit.title = "Rinomina";
  btnEdit.textContent = "";
  btnEdit.addEventListener("click", () => renameItem(sectionId, itemId));

  const btnDel = document.createElement("button");
  btnDel.className = "icon-btn danger";
  btnDel.type = "button";
  btnDel.title = "Elimina";
  btnDel.textContent = "";
  btnDel.addEventListener("click", () => deleteItem(sectionId, itemId));

  tools.appendChild(btnEdit);
  tools.appendChild(btnUp);
  tools.appendChild(btnDown);
  tools.appendChild(btnDel);

  titleRow.appendChild(titleLeft);
  titleRow.appendChild(tools);

  // --- Note ---
  const note = document.createElement("textarea");
  note.className = "note";
  note.rows = 2;
  note.placeholder = "Note (obbligatorie se KO)";
  note.value = item.note ?? "";
  if ((item.stato || "todo") === "ko" && !note.value.trim()) {
    note.classList.add("required");
  }

  note.addEventListener("input", () => {
    const it = findItem(sectionId, itemId);
    it.note = note.value;

    if (it.stato === "ko") {
      if (!it.note.trim()) note.classList.add("required");
      else note.classList.remove("required");
    }

    it.timestamp = nowIso();
touchAudit();
  });

  // --- Stati: in fondo a destra ---
  const footer = document.createElement("div");
  footer.className = "item-footer";

  const actions = document.createElement("div");
  actions.className = "item-actions";

  const st = item.stato || "todo";
  actions.appendChild(makeStateButton("todo", "Da fare", st === "todo", () => setState(sectionId, itemId, "todo")));
  actions.appendChild(makeStateButton("ok", "OK", st === "ok", () => setState(sectionId, itemId, "ok")));
  actions.appendChild(makeStateButton("ko", "KO", st === "ko", () => setState(sectionId, itemId, "ko")));
  actions.appendChild(makeStateButton("na", "N.A.", st === "na", () => setState(sectionId, itemId, "na")));

  footer.appendChild(actions);

  grid.appendChild(titleRow);
  grid.appendChild(note);
  grid.appendChild(footer);

  wrap.appendChild(grid);
  return wrap;
}

function renderSections(openSet = new Set()) {
  const container = document.getElementById("sections");
  container.innerHTML = "";

  const sectionsSorted = sortByOrder(model.sezioni);

  if (sectionsSorted.length === 0) {
    container.innerHTML = `<div class="empty-hint">Nessuna sezione presente.</div>`;
    return;
  }

  for (const section of sectionsSorted) {
    // --- wrapper sezione ---
    const details = document.createElement("details");
    details.className = "section";
    details.dataset.sectionId = section.id;
    details.open = openSet.has(section.id);

    // --- summary ---
    const summary = document.createElement("summary");

    // ====== LEFT: titolo + tools sezione ======
    const left = document.createElement("div");
    left.className = "section-title";

    const titleText = document.createElement("div");
    titleText.className = "section-title-text";
    titleText.textContent = section.titolo;

    const secTools = document.createElement("div");
    secTools.className = "section-tools";

    const sEdit = document.createElement("button");
    sEdit.className = "icon-btn";
    sEdit.type = "button";
    sEdit.title = "Rinomina sezione";
    sEdit.textContent = "";
    sEdit.addEventListener("click", (e) => {
      e.preventDefault();
      e.stopPropagation();
      renameSection(section.id);
    });

    const sUp = document.createElement("button");
    sUp.className = "icon-btn";
    sUp.type = "button";
    sUp.title = "Sposta sezione su";
    sUp.textContent = "";
    sUp.disabled = !canMoveSection(section.id, "up");
    sUp.addEventListener("click", (e) => {
      e.preventDefault();
      e.stopPropagation();
      moveSection(section.id, "up");
    });

    const sDown = document.createElement("button");
    sDown.className = "icon-btn";
    sDown.type = "button";
    sDown.title = "Sposta sezione gi";
    sDown.textContent = "";
    sDown.disabled = !canMoveSection(section.id, "down");
    sDown.addEventListener("click", (e) => {
      e.preventDefault();
      e.stopPropagation();
      moveSection(section.id, "down");
    });

    const sDel = document.createElement("button");
    sDel.className = "icon-btn danger";
    sDel.type = "button";
    sDel.title = "Elimina sezione (perde i controlli figli)";
    sDel.textContent = "";
    sDel.addEventListener("click", (e) => {
      e.preventDefault();
      e.stopPropagation();
      deleteSectionDangerous(section.id);
    });

    secTools.appendChild(sEdit);
    secTools.appendChild(sUp);
    secTools.appendChild(sDown);
    secTools.appendChild(sDel);

    left.appendChild(titleText);
    left.appendChild(secTools);
    // ====== /LEFT ======

    // --- RIGHT: progress ---
    const prog = computeSectionProgress(section);
    const right = document.createElement("div");
    right.className = "summary-right";

    const progLabel = document.createElement("div");
    progLabel.className = "progress-label";
    progLabel.textContent = `${prog.done}/${prog.total} (${prog.pct}%)`;

    const progBar = makeProgressNode(prog.pct);

    right.appendChild(progLabel);
    right.appendChild(progBar);

    // --- badges ---
    const badges = document.createElement("div");
    badges.className = "badges";
    const c = computeSectionBadges(section);
    badges.appendChild(makeBadge("todo", `Da fare ${c.todo}`));
    badges.appendChild(makeBadge("ok", `OK ${c.ok}`));
    badges.appendChild(makeBadge("ko", `KO ${c.ko}`));
    badges.appendChild(makeBadge("na", `N.A. ${c.na}`));

    summary.appendChild(left);
    summary.appendChild(right);
    summary.appendChild(badges);

    // --- body ---
    const body = document.createElement("div");
    body.className = "section-body";

    // azioni sezione nel body
    const rowActions = document.createElement("div");
    rowActions.className = "row-actions";

    const addBtn = document.createElement("button");
    addBtn.className = "btn btn-small";
    addBtn.textContent = "+ Aggiungi controllo";
    addBtn.addEventListener("click", (e) => {
      e.preventDefault();
      e.stopPropagation();
      addControl(section.id);
      openSection(section.id);
    });

    const small = document.createElement("div");
    small.className = "small-muted";
    small.textContent = "KO richiede note obbligatorie.";

    rowActions.appendChild(addBtn);
    rowActions.appendChild(small);
    body.appendChild(rowActions);

    // items
    const itemsSorted = sortByOrder(section.items || []);
    for (const item of itemsSorted) {
      body.appendChild(renderItem(section.id, item.id));
    }

    details.appendChild(summary);
    details.appendChild(body);
    container.appendChild(details);
  }
}

function rerenderAll() {
  // salva quali sezioni sono aperte (prima che la UI venga ricreata)
  const openIds = getOpenSectionIds();
  const openSet = new Set(openIds);

  updateSubtitle();
  renderMeta();
  renderSections(openSet);
}

/* ========================================================================== */
/* 10) ADD / EDIT ITEMS & SECTIONS                                             */
/* ========================================================================== */

function addControl(sectionId) {
  const section = findSection(sectionId);
  if (!section) return;

  const testo = prompt(`Nuovo controllo in "${section.titolo}":`);
  if (!testo || !testo.trim()) return;

  const existing = collectAllIds(model);
  const newId = makeUniqueId("itm", existing);

  const maxOrder = Math.max(0, ...(section.items || []).map(it => it.order ?? 0));
  section.items = section.items || [];
  section.items.push({
    id: newId,
    testo: testo.trim(),
    order: maxOrder + 10,
    stato: "todo",
    note: "",    timestamp: ""
  });

  touchAudit();
  rerenderAll();
  openSection(sectionId);
}

function addSection() {
  const titolo = prompt("Titolo nuova sezione:");
  if (!titolo || !titolo.trim()) return;

  const existing = collectAllIds(model);
  const newId = makeUniqueId("sec", existing);

  const maxOrder = Math.max(0, ...model.sezioni.map(s => s.order ?? 0));
  model.sezioni.push({
    id: newId,
    titolo: titolo.trim(),
    order: maxOrder + 10,
    items: []
  });

  touchAudit();
  rerenderAll();
  openSection(newId);
}

function canMove(sectionId, itemId, direction) {
  const s = findSection(sectionId);
  if (!s || !Array.isArray(s.items)) return false;

  const itemsSorted = sortByOrder(s.items);
  const idx = itemsSorted.findIndex(x => x.id === itemId);
  if (idx < 0) return false;

  if (direction === "up") return idx > 0;
  return idx < itemsSorted.length - 1;
}

function deleteItem(sectionId, itemId) {
  const s = findSection(sectionId);
  if (!s || !Array.isArray(s.items)) return;

  const it = findItem(sectionId, itemId);
  if (!it) return;

  const ok = confirm(`Eliminare questo controllo?\n\n- ${it.testo}`);
  if (!ok) return;

  s.items = s.items.filter(x => x.id !== itemId);

  touchAudit();
  rerenderAll();
}

function moveItem(sectionId, itemId, direction) {
  const s = findSection(sectionId);
  if (!s || !Array.isArray(s.items)) return;

  const itemsSorted = sortByOrder(s.items);
  const idx = itemsSorted.findIndex(x => x.id === itemId);
  if (idx < 0) return;

  const swapIdx = direction === "up" ? idx - 1 : idx + 1;
  if (swapIdx < 0 || swapIdx >= itemsSorted.length) return;

  const a = itemsSorted[idx];
  const b = itemsSorted[swapIdx];

  // scambio order (semplice, stabile)
  const ao = a.order ?? 0;
  const bo = b.order ?? 0;
  a.order = bo;
  b.order = ao;

  touchAudit();
  rerenderAll();
}

function renameItem(sectionId, itemId) {
  const it = findItem(sectionId, itemId);
  if (!it) return;

  const nuovo = prompt("Rinomina controllo:", it.testo || "");
  if (nuovo === null) return; // annullato
  const txt = nuovo.trim();
  if (!txt) return;

  it.testo = txt;
  it.timestamp = nowIso();
touchAudit();
  rerenderAll();
}

/* ========================================================================== */
/* 11) SECTION ACTIONS                                                         */
/* ========================================================================== */

function canMoveSection(sectionId, direction) {
  const sectionsSorted = sortByOrder(model.sezioni);
  const idx = sectionsSorted.findIndex(x => x.id === sectionId);
  if (idx < 0) return false;
  if (direction === "up") return idx > 0;
  return idx < sectionsSorted.length - 1;
}

function deleteSectionDangerous(sectionId) {
  const s = findSection(sectionId);
  if (!s) return;

  const count = (s.items || []).length;

  const msg =
    `ATTENZIONE: eliminerai la sezione "${s.titolo}"\n` +
    `e perderai anche ${count} controlli figli.\n\n` +
    `Per confermare, scrivi esattamente: elimina`;

  const typed = prompt(msg, "");
  if (typed === null) return;

  if (typed.trim().toLowerCase() !== "elimina") {
    alert("Conferma non valida. Nessuna modifica effettuata.");
    return;
  }

  model.sezioni = model.sezioni.filter(x => x.id !== sectionId);

  touchAudit();
  rerenderAll();
}

function moveSection(sectionId, direction) {
  const sectionsSorted = sortByOrder(model.sezioni);
  const idx = sectionsSorted.findIndex(x => x.id === sectionId);
  if (idx < 0) return;

  const swapIdx = direction === "up" ? idx - 1 : idx + 1;
  if (swapIdx < 0 || swapIdx >= sectionsSorted.length) return;

  const a = sectionsSorted[idx];
  const b = sectionsSorted[swapIdx];

  const ao = a.order ?? 0;
  const bo = b.order ?? 0;
  a.order = bo;
  b.order = ao;

  touchAudit();
  rerenderAll();
}

function renameSection(sectionId) {
  const s = findSection(sectionId);
  if (!s) return;

  const nuovo = prompt("Rinomina sezione:", s.titolo || "");
  if (nuovo === null) return;
  const txt = nuovo.trim();
  if (!txt) return;

  s.titolo = txt;
  touchAudit();
  rerenderAll();
}

/* ========================================================================== */
/* 12) STATE LOGIC                                                             */
/* ========================================================================== */

function setState(sectionId, itemId, state) {
  const it = findItem(sectionId, itemId);
  if (!it) return;

  // Se KO, prima controlla note (se esistono gi ok, altrimenti obbliga)
  if (state === "ko") {
    if (!String(it.note ?? "").trim()) {
      // settiamo lo stato, ma evidenziamo subito e lasciamo lutente scrivere note
      it.stato = "ko";
      it.timestamp = nowIso();
touchAudit();
      rerenderAll();
      alert("Stato KO: inserire le note (obbligatorie).");
      return;
    }
  }

  it.stato = state;
  it.timestamp = nowIso();
// Se stai uscendo da KO e le note erano marcate required, ok.
  touchAudit();
  rerenderAll();
}

/* ========================================================================== */
/* 13) IMPORT / EXPORT                                                         */
/* ========================================================================== */

function downloadTextFile(content, fileName, mimeType) {
  const blob = new Blob([content], { type: mimeType });
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = fileName;
  document.body.appendChild(a);
  a.click();
  a.remove();
  URL.revokeObjectURL(url);
}

function exportJson() {
  if (!model) return;

  // Validazione KO -> note obbligatorie
  const problems = [];
  for (const s of model.sezioni) {
    for (const it of s.items || []) {
      if ((it.stato || "todo") === "ko" && !String(it.note || "").trim()) {
        problems.push(`KO senza note: [${s.titolo}] ${it.testo}`);
      }
    }
  }
  if (problems.length) {
    alert("Impossibile esportare:\n\n" + problems.slice(0, 10).join("\n") + (problems.length > 10 ? "\n..." : ""));
    return;
  }

  model.app.lastSavedWith = "1.0.0";
  touchAudit();

  const suggested = makeSuggestedFileName();
  if (!suggested) return;

  downloadTextFile(
    JSON.stringify(model, null, 2),
    suggested,
    "application/json"
  );
}

function makeSuggestedFileName() {
  const nome = (model.meta.centraleNome || "").trim();
  const anno = String(model.meta.anno || "").trim();

  if (!nome || !anno) {
    alert("Impossibile esportare:\nCompilare almeno Centrale e Anno.");
    return null;
  }

  // Normalizzazione nome file:
  // - spazi  _
  // - niente caratteri strani
  const safeNome = nome
    .toUpperCase()
    .replace(/\s+/g, "_")
    .replace(/[^A-Z0-9_]/g, "");

  return `${safeNome}_${anno}.json`;
}


function openJsonFile(file) {
  const reader = new FileReader();
  reader.onload = () => {
    try {
      const parsed = JSON.parse(reader.result);
      const err = validateModel(parsed);
      if (err) {
        alert(err);
        return;
      }
      model = normalizeModel(parsed);
      openedFileName = file?.name || "";
      enableUi(true);
      bindAfterLoad();
      rerenderAll();
    } catch (e) {
      alert("Errore nel parsing JSON: " + e.message);
    }
  };
  reader.readAsText(file);
}

/* ========================================================================== */
/* 14) PDF                                                                     */
/* ========================================================================== */

async function generatePdf(isBlank) {
  if (!model) return;

  if (!window.jspdf || !window.jspdf.jsPDF) {
    alert("jsPDF non caricato. Controlla libs/jspdf.umd.min.js e lordine degli script.");
    return;
  }

  const { jsPDF } = window.jspdf;
  const doc = new jsPDF({ unit: "mm", format: "a4" });

  const centrale = model.meta.centraleNome || "";
  const anno = model.meta.anno || "";
  const preposto = model.meta.preposto || "";
  const operatori = (model.meta.operatori || "").trim();
  const dataInizio = model.meta.dataInizio || "";
  const dataFine = model.meta.dataFine || "";

  // --- HEADER: prima scriviamo SEMPRE testo (cos non esce mai vuoto) ---
  doc.setFontSize(14);
  doc.text(`Controlli sistematici - ${centrale} (${anno})`, 14, 16);

  doc.setFontSize(10);
  doc.text(`Preposto: ${preposto}`, 14, 22);
  if (operatori) {
    doc.text(`Operatori: ${operatori}`, 14, 32);
  }
  else {
    doc.text(`Operatori: ${preposto}`, 14, 32);
  }
  doc.text(`Periodo: ${dataInizio}  ${dataFine ? "-> " + dataFine : ""}`, 14, 27);

  doc.setDrawColor(200);
  doc.line(14, 39, 196, 39);


  // --- LOGO (offline file:// safe) ---
  try {
    doc.addImage(LOGO_DATA_URL, "JPEG", 175, 10, 25, 18);
  } catch (e) {
    console.warn("Logo non inserito:", e);
  }

  let y = 45;
  const canAutoTable = typeof doc.autoTable === "function";

  for (const section of sortByOrder(model.sezioni)) {
    const items = sortByOrder(section.items || []);
    if (y > 270) { doc.addPage(); y = 20; }

    doc.setFontSize(12);
    doc.text(section.titolo, 14, y);
    y += 4;

    if (canAutoTable) {
      const rows = items.map(it => {
        const st = isBlank ? "" : (it.stato || "todo");
        const box = stateToBox(st);
        const note = isBlank ? "" : (it.note || "");
        return [box, it.testo, note];
      });

      doc.autoTable({
        startY: y,
        head: [["", "Controllo", "Note"]],
        body: rows,
        theme: "grid",
        styles: { fontSize: 9, cellPadding: 2 },
        headStyles: { fontSize: 9 },
        columnStyles: {
          0: { cellWidth: 10 },
          1: { cellWidth: 110 },
          2: { cellWidth: 60 }
        }

      });

      y = doc.lastAutoTable.finalY + 8;
    } else {
      doc.setFontSize(10);
      for (const it of items) {
        if (y > 280) { doc.addPage(); y = 20; }
        const st = isBlank ? "" : (it.stato || "todo");        doc.text(`${stateToBox(st)} ${it.testo}`, 14, y);
        y += 5;
        if (!isBlank && it.note) {
          doc.setFontSize(9);
          doc.text(`Note: ${it.note}`, 18, y);
          y += 5;
          doc.setFontSize(10);
        }
      }
      y += 6;
    }
  }

  const pageCount = doc.getNumberOfPages();
  const gen = new Date().toLocaleString();

  for (let i = 1; i <= pageCount; i++) {
    doc.setPage(i);
    doc.setFontSize(9);
    doc.setTextColor(120);
    doc.text(`Generato: ${gen}`, 14, 290);
    doc.text(`Pagina ${i}/${pageCount}`, 180, 290);
    doc.setTextColor(0);
  }

  const safeNome = (centrale || "CENTRALE")
    .toUpperCase()
    .replace(/\s+/g, "_")
    .replace(/[^A-Z0-9_]/g, "");

  const fileName = isBlank
    ? `${safeNome}_${anno}_modulo_vuoto.pdf`
    : `${safeNome}_${anno}_stato.pdf`;

  doc.save(fileName);
}

function stateToBox(state) {
  // simboli semplici, stampabili
  // todo -> vuoto
  if (state === "ok") return "[x]";
  if (state === "ko") return "[!]";
  if (state === "na") return "[-]";
  return "[ ]";
}

function loadLogoDataUrl() {
  return new Promise((resolve) => {
    if (logoDataUrl) return resolve(logoDataUrl);

    const img = new Image();

    img.onload = () => {
      try {
        const canvas = document.createElement("canvas");
        canvas.width = img.naturalWidth;
        canvas.height = img.naturalHeight;

        const ctx = canvas.getContext("2d");
        ctx.drawImage(img, 0, 0);

        logoDataUrl = canvas.toDataURL("image/jpeg");
        resolve(logoDataUrl);
      } catch (err) {
        console.error("Errore canvas:", err);
        resolve(null);
      }
    };

    img.onerror = (e) => {
      console.error("Errore caricamento logo.jpg", e);
      resolve(null);
    };

    img.src = "assets/logo.jpg";
  });
}

/* ========================================================================== */
/* 15) EXPAND / COLLAPSE                                                       */
/* ========================================================================== */

function expandCollapseAll(open) {
  document.querySelectorAll("details.section").forEach(d => d.open = open);
}

/* ========================================================================== */
/* 16) INIT                                                                    */
/* ========================================================================== */

function bindAfterLoad() {
  // campi meta (una sola volta)
  // se gi bindati, non crea problemi gravi, ma meglio evitare in futuro
}

function init() {
  enableUi(false);

  const fileInput = document.getElementById("fileInput");
  document.getElementById("btnOpen").addEventListener("click", () => fileInput.click());
  fileInput.addEventListener("change", () => {
    const file = fileInput.files?.[0];
    if (file) openJsonFile(file);
    fileInput.value = "";
  });

  document.getElementById("btnSave").addEventListener("click", exportJson);
  document.getElementById("btnPdfBlank").addEventListener("click", () => generatePdf(true));
  document.getElementById("btnPdfState").addEventListener("click", () => generatePdf(false));

  document.getElementById("btnExpandAll").addEventListener("click", () => expandCollapseAll(true));
  document.getElementById("btnCollapseAll").addEventListener("click", () => expandCollapseAll(false));

  document.getElementById("btnAddSection").addEventListener("click", addSection);

  bindMeta();
}

/* ========================================================================== */
/* 17) BOOT                                                                   */
/* ========================================================================== */

init();