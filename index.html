<!doctype html>
<html lang="it">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Controlli Sistematici</title>
  <link rel="icon" href="assets/favicon.png" type="image/png" />
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <header class="topbar">
    <div class="brand">
      <img class="app-logo" src="assets/logo.jpg" alt="Logo" />
      <div class="title">
        <h1>Controlli sistematici</h1>
        <div id="subtitle" class="subtitle">Apri un file JSON per iniziare.</div>
      </div>
    </div>

    <div class="toolbar">
      <input id="fileInput" type="file" accept=".json,application/json" hidden />
      <button id="btnNew" class="btn btn-icon">
        <!-- Icona: documento con simbolo "+" per creare un nuovo file -->
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <!-- Sagoma documento con angolo piegato -->
          <path d="
            M5 3
            h10 l4 4
            v12
            a2 2 0 0 1-2 2H5
            a2 2 0 0 1-2-2V5
            a2 2 0 0 1 2-2
            z
            m10 1.5
            V8
            h3.5
            L15 4.5
            z">
          </path>
          <!-- Simbolo "+" -->
          <path d="
            M12 11
            a1 1 0 0 1 1 1
            v2
            h2
            a1 1 0 1 1 0 2
            h-2
            v2
            a1 1 0 1 1-2 0
            v-2
            H9
            a1 1 0 1 1 0-2
            h2
            v-2
            a1 1 0 0 1 1-1
            z">
          </path>
        </svg>
        <span>Nuovo</span>
      </button>
      <button id="btnOpen" class="btn btn-icon">
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path d="M3 6a2 2 0 0 1 2-2h5l2 2h7a2 2 0 0 1 2 2v3h-2V8H11.17l-2-2H5v12h6v2H5a2 2 0 0 1-2-2V6z"></path>
          <path d="M13 12h8l-3.5-3.5 1.4-1.4L24 12l-5.1 4.9-1.4-1.4L21 14h-8v-2z"></path>
        </svg>
        <span>Apri</span>
      </button>
      <button id="btnSave" class="btn btn-primary btn-icon" disabled>
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path
            d="M4 4h12l4 4v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2zm2 0v6h10V6.5L13.5 4H6zm0 10v6h12v-6H6z">
          </path>
        </svg>
        <span>Salva</span>
      </button>
      <button id="btnClose" class="btn btn-icon" disabled>
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path
            d="M6 5h12a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2zm3.4 4.6L12 12.2l2.6-2.6 1.4 1.4L13.4 13.6l2.6 2.6-1.4 1.4L12 15l-2.6 2.6-1.4-1.4 2.6-2.6-2.6-2.6 1.4-1.4z">
          </path>
        </svg>
        <span>Chiudi</span>
      </button>
      <button id="btnResetStates" class="btn" disabled>Reset stati</button>
      <button id="btnExpandAll" class="btn" disabled>Espandi sezioni</button>
      <button id="btnCollapseAll" class="btn" disabled>Collassa sezioni</button>
      <button id="btnToggleCompleted" class="btn" disabled>Nascondi completati</button>
      <button id="btnPdfBlank" class="btn" disabled>PDF modulo vuoto</button>
      <button id="btnPdfState" class="btn" disabled>PDF stato attuale</button>
    </div>

    <div id="globalProgressBar" class="global-progress">
      <div class="global-progress__row">
        <div class="global-progress__label">
          Avanzamento totale: <span id="globalProgressText">0%</span>
          <span id="globalProgressCounts" class="muted"></span>
        </div>
      </div>
      <div class="global-progress__track">
        <div id="globalProgressFill" class="global-progress__fill" style="width:0%"></div>
      </div>
    </div>

  </header>

  <main class="container">
    <section class="panel">
      <div class="panel-head">
        <div class="panel-title">Dati generali</div>
        <div class="panel-actions"></div>
      </div>

      <div class="meta-grid">
        <label>
          <span>Centrale</span>
          <input id="metaCentraleNome" type="text" placeholder="es. Centrale A" disabled />
        </label>
        <label>
          <span>Anno</span>
          <input id="metaAnno" type="number" min="2000" max="2100" disabled />
        </label>
        <label>
          <span>Preposto</span>
          <input id="metaPreposto" type="text" placeholder="es. Rossi" disabled />
        </label>
        <label>
          <span>Operatori</span>
          <input id="metaOperatori" type="text" placeholder="es. Bianchi, sennò sarà il preposto" disabled />
        </label>
        <label>
          <span>Data inizio</span>
          <input id="metaDataInizio" type="date" disabled />
        </label>
        <label>
          <span>Data fine</span>
          <input id="metaDataFine" type="date" disabled />
        </label>
        <label>
          <span>Ore funzionamento</span>
          <input id="metaOreFunzionamento" type="number" min="0" step="0.1" placeholder="es. 1250" disabled />
        </label>
        <label class="full">
          <span>Note generali</span>
          <textarea id="metaNoteGenerali" rows="2" disabled></textarea>
        </label>
      </div>
    </section>

    <section class="panel">
      <div class="panel-head">
        <div class="panel-title">Sezioni</div>
        <div class="panel-actions">
          <button id="btnAddSection" class="btn btn-small" disabled>+ Aggiungi sezione</button>
        </div>
      </div>

      <div id="sections" class="sections">
        <div class="empty-hint">Nessun file caricato.</div>
      </div>
    </section>
  </main>

  <!-- Lib PDF offline -->
  <script src="libs/jspdf.umd.min.js"></script>
  <script src="libs/jspdf-autotable.min.js"></script>

  <!-- Logo inline fallback per file:// -->
  <script src="assets/logo.inline.js"></script>

  <!-- App -->
  <script src="pdf.js"></script>
  <script src="app.js"></script>
</body>

</html>
