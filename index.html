<!doctype html>
<html lang="it">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Controlli Sistematici</title>
  <link rel="icon" href="assets/favicon.png" type="image/png" />
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <header class="topbar">
    <div class="brand">
      <img class="app-logo" src="assets/logo.jpg" alt="Logo" />
      <div class="title">
        <h1>Generatore Report per controlli sistematici v1.2.1</h1>
        <div id="subtitle" class="subtitle">Apri un file JSON per iniziare.</div>
      </div>
    </div>

    <div class="toolbar">
      <input id="fileInput" type="file" accept=".json,application/json" hidden />
      <div class="toolbar-group toolbar-main">
        <button id="btnNew" class="btn btn-icon">
          <!-- Icona: documento con simbolo "+" per creare un nuovo file -->
          <!-- SVG: foglio + segno aggiunta -->
          <svg viewBox="0 0 24 24" aria-hidden="true" class="icon-fill">
            <!-- Sagoma documento con angolo piegato -->
            <path d="
              M5 3
              h10 l4 4
              v12
              a2 2 0 0 1-2 2H5
              a2 2 0 0 1-2-2V5
              a2 2 0 0 1 2-2
              z
              m10 1.5
              V8
              h3.5
              L15 4.5
              z">
            </path>
            <!-- Simbolo "+" -->
            <path d="
              M12 11
              a1 1 0 0 1 1 1
              v2
              h2
              a1 1 0 1 1 0 2
              h-2
              v2
              a1 1 0 1 1-2 0
              v-2
              H9
              a1 1 0 1 1 0-2
              h2
              v-2
              a1 1 0 0 1 1-1
              z">
            </path>
          </svg>
          <span>Nuovo</span>
        </button>
        <button id="btnOpen" class="btn btn-icon">
          <!-- SVG: cartella con freccia in ingresso (apri) -->
          <svg viewBox="0 0 24 24" aria-hidden="true" class="icon-fill">
            <path d="M3 6a2 2 0 0 1 2-2h5l2 2h7a2 2 0 0 1 2 2v3h-2V8H11.17l-2-2H5v12h6v2H5a2 2 0 0 1-2-2V6z"></path>
            <path d="M13 12h8l-3.5-3.5 1.4-1.4L24 12l-5.1 4.9-1.4-1.4L21 14h-8v-2z"></path>
          </svg>
          <span>Apri</span>
        </button>
        <button id="btnSave" class="btn btn-primary btn-icon" disabled>
          <!-- SVG: dischetto/salvataggio -->
          <svg viewBox="0 0 24 24" aria-hidden="true" class="icon-fill">
            <path
              d="M4 4h12l4 4v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2zm2 0v6h10V6.5L13.5 4H6zm0 10v6h12v-6H6z">
            </path>
          </svg>
          <span>Salva</span>
        </button>
        <button id="btnPdfState" class="btn btn-primary btn-icon" disabled>
          <!-- SVG: documento con freccia verso il basso (esporta PDF) -->
          <svg viewBox="0 0 24 24" aria-hidden="true" class="icon-stroke">
            <path d="M6 3h9l4 4v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z"></path>
            <path d="M15 3v5h5"></path>
            <path d="M12 11v6"></path>
            <path d="M9 14l3 3 3-3"></path>
          </svg>
          <span>Esporta PDF</span>
        </button>
      </div>
      <div class="toolbar-group toolbar-secondary">
        <details class="toolbar-more">
          <summary class="btn btn-icon">
            <!-- SVG: tre punti orizzontali (menu altro) -->
            <svg viewBox="0 0 24 24" aria-hidden="true" class="icon-fill">
              <circle cx="6" cy="12" r="1.5"></circle>
              <circle cx="12" cy="12" r="1.5"></circle>
              <circle cx="18" cy="12" r="1.5"></circle>
            </svg>
            <span>Altro</span>
          </summary>
          <div class="toolbar-more-panel">
            <button id="btnExpandAll" class="btn btn-icon" disabled>
              <!-- SVG: chevron giù (espandi) -->
              <svg viewBox="0 0 24 24" aria-hidden="true" class="icon-stroke">
                <path d="M7 9l5 5 5-5"></path>
              </svg>
              <span>Espandi sezioni</span>
            </button>
            <button id="btnCollapseAll" class="btn btn-icon" disabled>
              <!-- SVG: chevron su (collassa) -->
              <svg viewBox="0 0 24 24" aria-hidden="true" class="icon-stroke">
                <path d="M7 15l5-5 5 5"></path>
              </svg>
              <span>Collassa sezioni</span>
            </button>
            <button id="btnToggleCompleted" class="btn btn-icon" disabled>
              <!-- SVG: occhio (mostra/nascondi completati) -->
              <svg viewBox="0 0 24 24" aria-hidden="true" class="icon-stroke">
                <path d="M3 12s3.5-6 9-6 9 6 9 6-3.5 6-9 6-9-6-9-6z"></path>
                <circle cx="12" cy="12" r="2.2"></circle>
              </svg>
              <span>Nascondi completati</span>
            </button>
            <button id="btnResetStates" class="btn btn-icon" disabled>
              <!-- SVG: freccia circolare (reset) -->
              <svg viewBox="0 0 24 24" aria-hidden="true" class="icon-stroke">
                <path d="M20 12a8 8 0 1 1-2.3-5.7"></path>
                <path d="M20 5v5h-5"></path>
              </svg>
              <span>Reset tutti stati</span>
            </button>
            <button id="btnPdfBlank" class="btn btn-icon" disabled>
              <!-- SVG: documento con riga (PDF vuoto) -->
              <svg viewBox="0 0 24 24" aria-hidden="true" class="icon-stroke">
                <path d="M6 3h9l4 4v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z"></path>
                <path d="M15 3v5h5"></path>
                <path d="M8 13h8"></path>
              </svg>
              <span>Esporta PDF vuoto</span>
            </button>
          </div>
        </details>
      </div>
    </div>

    <div id="globalProgressBar" class="global-progress">
      <div class="global-progress__row">
        <div class="global-progress__label">
          Avanzamento totale: <span id="globalProgressText">0%</span>
          <span id="globalProgressCounts" class="muted"></span>
        </div>
      </div>
      <div class="global-progress__track">
        <div id="globalProgressFill" class="global-progress__fill" style="width:0%"></div>
      </div>
    </div>

  </header>

  <main class="container">
    <section class="panel">
      <div class="panel-head">
        <div class="panel-title">Dati generali</div>
        <div class="panel-actions"></div>
      </div>

      <div class="meta-grid">
        <label>
          <span>Centrale</span>
          <input id="metaCentraleNome" type="text" placeholder="es. Centrale A" disabled />
        </label>
        <label>
          <span>Anno</span>
          <input id="metaAnno" type="number" min="2000" max="2100" disabled />
        </label>
        <label>
          <span>Preposto</span>
          <input id="metaPreposto" type="text" placeholder="es. Rossi" disabled />
        </label>
        <label>
          <span>Operatori</span>
          <input id="metaOperatori" type="text" placeholder="es. Bianchi, sennò sarà il preposto" disabled />
        </label>
        <label>
          <span>Data inizio</span>
          <input id="metaDataInizio" type="date" disabled />
        </label>
        <label>
          <span>Data fine</span>
          <input id="metaDataFine" type="date" disabled />
        </label>
        <label>
          <span>Ore funzionamento</span>
          <input id="metaOreFunzionamento" type="number" min="0" step="0.1" placeholder="es. 1250" disabled />
        </label>
        <label class="full">
          <span>Note generali</span>
          <textarea id="metaNoteGenerali" rows="2" disabled></textarea>
        </label>
      </div>
    </section>

    <section class="panel">
      <div class="panel-head">
        <div class="panel-title">Sezioni</div>
        <div class="panel-actions">
          <button id="btnAddSection" class="btn btn-small" disabled>+ Aggiungi sezione</button>
        </div>
      </div>

      <div id="sections" class="sections">
        <div class="empty-hint">Nessun file caricato.</div>
      </div>
    </section>
  </main>

  <!-- Lib PDF offline -->
  <script src="libs/jspdf.umd.min.js"></script>
  <script src="libs/jspdf-autotable.min.js"></script>

  <!-- Logo inline fallback per file:// -->
  <script src="assets/logo.inline.js"></script>

  <!-- App -->
  <script src="pdf.js"></script>
  <script src="app.js"></script>
</body>

</html>
